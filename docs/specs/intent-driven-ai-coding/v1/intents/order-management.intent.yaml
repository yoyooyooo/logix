id: order-management
title: 订单管理列表
description: 管理订单的列表 / 搜索 / 快速编辑 / 导出功能

goals:
  - 让运营在单页内完成大部分订单处理动作
  - 支持高频搜索与筛选，减少切页
  - 统一导出能力，避免每个页面重复接入

scene:
  type: list-page
  layout:
    regions:
      - id: filters
        label: 筛选区
        role: filter-bar
      - id: toolbar
        label: 工具栏
        role: actions
      - id: table
        label: 列表
        role: data-table
  actors:
    - role: ops
      description: 日常处理订单的运营同学
  flows:
    - from: 进入订单管理页面
      to: 筛选区
      action: 选择状态/日期等筛选条件
    - from: 筛选区
      to: 列表
      action: 根据筛选条件加载订单列表
    - from: 列表
      to: 快速编辑弹层
      action: 点击某行快速编辑按钮
    - from: 快速编辑弹层
      to: 列表
      action: 提交修改并刷新当前页
    - from: 工具栏
      to: 导出任务
      action: 点击导出按钮按当前筛选条件导出

runtimeFlows:
  - id: exportOrders
    trigger:
      element: toolbar.exportButton
      event: click
    pipeline:
      - call: FilterService.getCurrentFilters
        as: filters
      - call: TableUiStateService.getCurrentState
        as: tableState
      - call: ExportService.submitExportTask
        params:
          filters: "{{filters}}"
          columns: "{{tableState.visibleColumns}}"

patterns:
  - id: table-with-server-filter
    target: table
    config:
      entity: Order
      pagination: true
      batchActions:
        - export
  - id: filter-bar
    target: filters
    config:
      inlineSearch: true
      showResetButton: true
      fields:
        - status
        - createdAt
  - id: toolbar-with-quick-edit
    target: toolbar
    config:
      supportQuickEdit: true
      supportExport: true
      editableFields:
        - remark

domain:
  entities:
    - name: Order
      fields:
        - id: string
        - status: enum[PENDING, PAID, SHIPPED, COMPLETED, CANCELED]
        - createdAt: datetime
        - updatedAt: datetime
        - buyerName: string
        - totalAmount: number
        - remark: string
  apis:
    - name: listOrders
      path: /api/orders
      method: GET
      query:
        - name: keyword
          type: string
          optional: true
        - name: status
          type: string
          optional: true
        - name: createdAtFrom
          type: datetime
          optional: true
        - name: createdAtTo
          type: datetime
          optional: true
        - name: page
          type: number
        - name: pageSize
          type: number
      returns: Paginated<Order>
    - name: updateOrder
      path: /api/orders/{id}
      method: PATCH
      body:
        - name: remark
          type: string
          optional: true
        - name: status
          type: string
          optional: true
    - name: exportOrders
      path: /api/orders/export
      method: POST
      body:
        - name: filters
          type: object

openQuestions:
  - 导出是否需要限制最大条数？
  - 是否允许在快速编辑中修改订单状态？

autoFill:
  - 根据 Order 字段自动生成表格列初稿（id/status/createdAt/totalAmount）
  - 根据 listOrders 查询参数自动生成过滤项
