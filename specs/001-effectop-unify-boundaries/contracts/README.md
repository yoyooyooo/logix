# Contracts: 001-effectop-unify-boundaries

> 本特性主要引入的是 **库级 TypeScript API 契约**（而非 HTTP/GraphQL 接口）。因此，这里的 "contracts" 用于列出对外可见的运行时 API 形状与行为约束。

## 1) 统一边界执行契约（强制进入总线）

- 所有当前已存在的边界操作类型（包含内部类边界与调试类边界）必须统一提升为 Operation，并进入同一条 middleware 管线执行。
- 若 middleware stack 为空，行为必须与“未引入总线”时等价（直通）。

## 2) Operation Meta 契约（防呆核心）

- `linkId`（操作链路 id）是必填：用于把同一链路下的多次边界操作关联起来。
- Runtime 负责尽可能自动补齐关键 meta（例如 module/runtime/transaction 相关信息），并保证嵌套操作复用同一 linkId。

## 3) 全局 vs 局部策略优先级（不可被误用）

- 全局守卫不可被局部关闭；
- 局部策略只允许追加信息或收紧约束；
- 局部策略可关闭“纯观测类”能力（仅影响 Observer，不影响 Runner/Guard）。

## 4) 守卫拒绝语义

- 守卫拒绝必须对调用方表现为“显式拒绝失败”（可与成功区分）；
- 拒绝必须发生在用户程序执行前，且不产生任何业务副作用；
- 拒绝应可被观测（至少具备可识别原因/来源信息）。

## 5) 移除遗留入口

- 删除/禁用历史遗留的“局部加固/包一层”入口，并确保公共 API、示例与用户文档不再引用。
- 如需表达“局部差异化策略”，只能通过 Operation Meta 的局部策略标注完成。

