# Quickstart: 001-effectop-unify-boundaries

**Feature**: `/Users/yoyo/Documents/code/personal/intent-flow/specs/001-effectop-unify-boundaries/spec.md`  
**Goal**: 用最小示例证明三件事：所有边界必经总线、守卫拒绝是显式失败且无副作用、同一链路可通过 linkId 关联。

## 1) 最小验收场景

在一个最小模块/最小应用中触发以下操作序列（同一次用户交互/同一业务意图）：

1. 触发一次交互入口（例如“提交/删除”之类的边界起点）
2. 触发至少一次服务调用边界
3. 触发至少一次状态变更边界
4. 触发至少一次生命周期/调试类边界（用于覆盖 Q1 的“全部边界类型”）

## 2) 配置全局中间件（Observer + Guard）

全局中间件需要满足：

- Observer：记录每次 Operation 的 `kind/name/linkId`，用于证明“全部边界都进入管线”
- Guard：基于某个条件拒绝其中一类操作，验证拒绝语义

验收要点：

- 每次边界操作都有观测记录
- 对被拒绝的操作：调用方获得“显式拒绝失败”
- 被拒绝操作的业务副作用没有发生

## 3) 局部策略标注（不改变写法，只增加最小标注）

对其中某一条操作增加局部策略标注，用于：

- 关闭纯观测能力（验证局部可关闭 Observer）
- 追加标签/信息（验证局部只追加/收紧，不允许关闭全局守卫）

验收要点：

- 局部标注能影响 Observer 行为
- 全局 Guard 仍然生效（局部不能关闭）

## 4) 链路关联（linkId）

验收要点：

- 同一次交互触发的多步边界操作携带同一个 `linkId`
- 下一次独立交互触发的链路拥有不同的 `linkId`

## 5) 完成定义（DoD）

- 覆盖率：当前所有边界类型均可被全局 Observer 观测到（含内部与调试类边界）
- 拒绝语义：拒绝为显式失败且无副作用
- 优先级：局部不能关闭全局守卫；局部可关闭纯观测能力
- 关联：linkId 存在且可串联多步操作

